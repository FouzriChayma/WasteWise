{% extends 'baseLogin.html.twig' %}

{% block title %}Log in!{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        /* Style des champs du formulaire */
        .form-control {
            border-radius: 20px; /* Rendre les champs ronds */
            border: 1px solid #ced4da; /* Bordure par défaut */
            margin-bottom: 20px; /* Espacement entre chaque champ */
            padding: 15px; /* Ajouter du rembourrage */
            font-size: 16px; /* Taille de police */
        }

        /* Style du bouton Log in */
        .btn-primary {
            border-radius: 20px; /* Rendre le bouton rond */
            background-color: #28a745; /* Couleur verte */
            border-color: #28a745; /* Bordure verte */
            width: 100%; /* Largeur du bouton */
            padding: 15px; /* Ajouter du rembourrage */
            font-size: 18px; /* Taille de police */
            font-weight: bold; /* Gras */
            text-transform: uppercase; /* Mettre en majuscules */
            transition: background-color 0.3s, border-color 0.3s; /* Transition fluide */
        }

        .btn-primary:hover {
            background-color: #218838; /* Couleur verte plus foncée au survol */
            border-color: #1e7e34; /* Bordure plus foncée au survol */
            cursor: pointer; /* Changer le curseur au survol */
        }

        /* Agrandir la taille du formulaire */
        .auth-form-container {
            max-width: 400px; /* Largeur maximale du formulaire */
            margin: 0 auto; /* Centrer horizontalement */
        }

        /* Autres styles existants ... */
    </style>
{% endblock %}

{% block body %}
<div class="row g-0 app-auth-wrapper">
    <div class="col-12 col-md-7 col-lg-6 auth-main-col text-center p-5">
        <div class="d-flex flex-column align-content-end">
            <div class="app-auth-body mx-auto">    
                <div class="app-auth-branding mb-4"><a class="app-logo" href="index.html"><img class="logo-icon me-2" src="{{asset('Back/assets/images/logo (1).png')}}" alt="logo" style="width: 100px; height: auto;"></a></div>
                <h2 class="auth-heading text-center mb-4" style="color: black; font-size: 30px;">Log in into Waste Wise</h2>
                <p class="text-center mb-4">Join the Green Revolution - Login to Make A Difference !</p>
               
                <div class="auth-form-container text-start">
                    {% for message in app.flashes('notverified') %}
                        <div class="alert alert-danger">
                            {{ message }}
                        </div>
                    {% endfor %}
                    {% for message in app.flashes('success') %}
                        <div class="alert alert-success">
                            {{ message }}
                        </div>
                    {% endfor %}
                    <form class="auth-form login-form" method="post">
                        {% if error %}
                            <div class="alert alert-danger">{{ error.messageKey|trans(error.messageData, 'security') }}</div>
                        {% endif %}  
                        {% if app.user %}
    {% if app.user.isBanned == 1 %}
    <center>
        <div class="mb-3" style="color:red;">
            You are Banned
        </div>
        </center>
    {% endif %}
      {% if app.user.IsVerified == 0 %}
    <center>
        <div class="mb-3" style="color:red;">
            You are Not verified
        </div>
        </center>
    {% endif %}
    {% endif %}
    {% if app.flashes('success') %}
    <div class="alert alert-success" role="alert">
        {% for message in app.flashes('success') %}
            {{ message }}
        {% endfor %}
    </div>
{% endif %}

       
                        <div class="email mb-3">
                            <label class="sr-only" for="signin-email">Email</label>
                            <input type="email" value="{{ last_username }}" name="email" id="inputEmail" class="form-control signin-email" placeholder="Email address" autocomplete="email" required autofocus>
                        </div>
                        <div class="password mb-3">
                            <label class="sr-only" for="signin-password">Password</label>
                            <input type="password" name="password" id="inputPassword" class="form-control signin-password" placeholder="Password" autocomplete="password" required>
                            <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">
                        </div>
                        <div class="extra mt-3 row justify-content-between">
                            <div class="col-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="" id="RememberPassword">
                                    <label class="form-check-label" for="RememberPassword">
                                        Remember me
                                    </label>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="forgot-password text-end">
                                    <a  href="{{ path('app_forgot_password_request') }}">Forgot password?</a>
                                </div>
                            </div>
                        </div>
                        <div class="text-center">
                            <button type="submit" class="btn btn-primary w-100">Log In</button>
                        </div>
                    </form>
                    <button onclick="facebookLogin()" class="btn btn-primary w-100">Login with Facebook</button>

<script>
  // Initialize the Facebook SDK
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1051154525980237',
      cookie     : true,
      xfbml      : true,
      version    : 'v12.0'
    });
      
    // Triggered after login status changes
    FB.Event.subscribe('auth.statusChange', function(response) {
      if (response.authResponse) {
        // User is logged in
        checkLoginState();
      }
    });
  };

  // Load the SDK asynchronously
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "https://connect.facebook.net/en_US/sdk.js";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));

  // Function to trigger Facebook login
  function facebookLogin() {
    FB.login(function(response) {
      if (response.authResponse) {
        // User is logged in, check login state
        checkLoginState();
      } else {
        // User cancelled login or did not authorize
        console.log('User cancelled login or did not fully authorize.');
      }
    }, {scope: 'public_profile,email'});
  }

  // Function to handle login state
  function checkLoginState() {
    FB.getLoginStatus(function(response) {
      if (response.status === 'connected') {
        // User is logged in and authorized
        var accessToken = response.authResponse.accessToken;
        // You can now fetch user data or perform other actions
        console.log('User is logged in and authorized.');
      } else {
        // User is not logged in or authorized
        console.log('User is not logged in or authorized.');
      }
    });
  }
</script>



                    <div class="auth-option text-center pt-5">No Account? Sign up <a class="text-link" href="{{path('app_register')}}">here</a>.</div>
                </div><!--//auth-form-container-->   
            </div><!--//auth-body-->
            <footer class="app-auth-footer">
                <div class="container text-center py-3">
                </div>
            </footer><!--//app-auth-footer-->    
        </div><!--//flex-column-->   
    </div><!--//auth-main-col-->
   <div class="col-12 col-md-5 col-lg-6 h-100 auth-background-col" style="position: relative; background-color: #28a745;">
    <!-- Image de fond -->
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('{{ asset('Back/assets/images/Yellow Illustration Simple environmental cleaning competition Instagram Story (4).png') }}'); background-size: contain; background-position: center; background-repeat: no-repeat;"></div>
    <!-- Masque pour le formulaire -->
    <div class="auth-background-mask"></div>
</div><!--//auth-background-col-->

{% endblock %}
